
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>DOEDriver &#8212; OpenMDAO 2.8.0 Beta documentation</title>
    <link rel="stylesheet" href="../../../_static/style.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../../../_static/OpenMDAO_Favicon.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Solvers" href="../solvers/index.html" />
    <link rel="prev" title="SimpleGADriver" href="genetic_algorithm.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../solvers/index.html" title="Solvers"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="genetic_algorithm.html" title="SimpleGADriver"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">OpenMDAO 2.8.0 Beta documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Features</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../index.html" >Building Blocks</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="index.html" accesskey="U">Drivers</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../index.html">
              <img class="logo" src="../../../_static/OpenMDAO_Logo.png" alt="Logo"/>
            </a></p>
<h3><a href="../../../index.html">Table of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../getting_started/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../basic_guide/index.html">Basic User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../advanced_guide/index.html">Advanced User Guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../theory_manual/index.html">Theory Manual</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../other/om_command.html">Command Line Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../other/citing.html">How to Cite OpenMDAO</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../other/repo_guide/index.html">Building a Tool on Top of OpenMDAO</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../other/api_translation.html">Upgrading from OpenMDAO 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../other/file_wrap.html">File Wrapping</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../_srcdocs/index.html">Source Docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developer_docs/index.html">Developer Docs (if you’re going to contribute code)</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Search OpenMDAO</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="checkbox" name="search_source" /> Include Source Docs
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="doedriver">
<span id="doe-driver"></span><h1>DOEDriver<a class="headerlink" href="#doedriver" title="Permalink to this headline">¶</a></h1>
<p><code class="xref py py-class docutils literal notranslate"><span class="pre">DOEDriver</span></code> facilitates performing a
design of experiments (DOE) with your OpenMDAO model.
It will run your model multiple times with different values for the design variables
depending on the selected input generator. A number of generators are available, each with
its own parameters that can be specified when it is instantiated:</p>
<ul class="simple">
<li><a class="reference internal" href="../../../_srcdocs/packages/drivers/doe_generators.html#openmdao.drivers.doe_generators.UniformGenerator" title="openmdao.drivers.doe_generators.UniformGenerator"><code class="xref py py-class docutils literal notranslate"><span class="pre">UniformGenerator</span></code></a></li>
<li><a class="reference internal" href="../../../_srcdocs/packages/drivers/doe_generators.html#openmdao.drivers.doe_generators.FullFactorialGenerator" title="openmdao.drivers.doe_generators.FullFactorialGenerator"><code class="xref py py-class docutils literal notranslate"><span class="pre">FullFactorialGenerator</span></code></a></li>
<li><a class="reference internal" href="../../../_srcdocs/packages/drivers/doe_generators.html#openmdao.drivers.doe_generators.PlackettBurmanGenerator" title="openmdao.drivers.doe_generators.PlackettBurmanGenerator"><code class="xref py py-class docutils literal notranslate"><span class="pre">PlackettBurmanGenerator</span></code></a></li>
<li><a class="reference internal" href="../../../_srcdocs/packages/drivers/doe_generators.html#openmdao.drivers.doe_generators.BoxBehnkenGenerator" title="openmdao.drivers.doe_generators.BoxBehnkenGenerator"><code class="xref py py-class docutils literal notranslate"><span class="pre">BoxBehnkenGenerator</span></code></a></li>
<li><a class="reference internal" href="../../../_srcdocs/packages/drivers/doe_generators.html#openmdao.drivers.doe_generators.LatinHypercubeGenerator" title="openmdao.drivers.doe_generators.LatinHypercubeGenerator"><code class="xref py py-class docutils literal notranslate"><span class="pre">LatinHypercubeGenerator</span></code></a></li>
<li><a class="reference internal" href="../../../_srcdocs/packages/drivers/doe_generators.html#openmdao.drivers.doe_generators.CSVGenerator" title="openmdao.drivers.doe_generators.CSVGenerator"><code class="xref py py-class docutils literal notranslate"><span class="pre">CSVGenerator</span></code></a></li>
<li><a class="reference internal" href="../../../_srcdocs/packages/drivers/doe_generators.html#openmdao.drivers.doe_generators.ListGenerator" title="openmdao.drivers.doe_generators.ListGenerator"><code class="xref py py-class docutils literal notranslate"><span class="pre">ListGenerator</span></code></a></li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><cite>FullFactorialGenerator</cite>, <cite>PlackettBurmanGenerator</cite>, <cite>BoxBehnkenGenerator</cite> and
<cite>LatinHypercubeGenerator</cite> are provided via the <a class="reference external" href="https://pypi.org/project/pyDOE2">pyDOE2</a> package, which is an
updated version of <a class="reference external" href="https://pythonhosted.org/pyDOE">pyDOE</a>.  See the original <a class="reference external" href="https://pythonhosted.org/pyDOE">pyDOE</a> page for information on
those algorithms.</p>
</div>
<p>The generator instance may be supplied as an argument to the <cite>DOEDriver</cite> or as an option.</p>
<div class="section" id="doedriver-options">
<h2>DOEDriver Options<a class="headerlink" href="#doedriver-options" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="8%" />
<col width="6%" />
<col width="9%" />
<col width="8%" />
<col width="70%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Option</th>
<th class="head">Default</th>
<th class="head">Acceptable Values</th>
<th class="head">Acceptable Types</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>debug_print</td>
<td>[]</td>
<td>N/A</td>
<td>[‘list’]</td>
<td>List of what type of Driver variables to print at each iteration. Valid items in list are ‘desvars’, ‘ln_cons’, ‘nl_cons’, ‘objs’, ‘totals’</td>
</tr>
<tr class="row-odd"><td>generator</td>
<td>DOEGenerator</td>
<td>N/A</td>
<td>[‘DOEGenerator’]</td>
<td>The case generator. If default, no cases are generated.</td>
</tr>
<tr class="row-even"><td>procs_per_model</td>
<td>1</td>
<td>N/A</td>
<td>[‘int’]</td>
<td>Number of processors to give each model under MPI.</td>
</tr>
<tr class="row-odd"><td>run_parallel</td>
<td>False</td>
<td>[True, False]</td>
<td>[‘bool’]</td>
<td>Set to True to execute cases in parallel.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="simple-example">
<h2>Simple Example<a class="headerlink" href="#simple-example" title="Permalink to this headline">¶</a></h2>
<p><cite>UniformGenerator</cite> implements the simplest method and will generate a requested number of
samples randomly selected from a uniform distribution across the valid range for each
design variable. This example demonstrates its use with a model built on the
<a class="reference internal" href="../../../basic_guide/first_analysis.html#tutorial-paraboloid-analysis"><span class="std std-ref">Paraboloid</span></a> Component.
An <a class="reference internal" href="../../recording/saving_data.html#saving-data"><span class="std std-ref">SqliteRecorder</span></a> is used to capture the cases that were generated.
We can see that that the model was evaluated at random values of <code class="code docutils literal notranslate"><span class="pre">x</span></code> and <code class="code docutils literal notranslate"><span class="pre">y</span></code>
between -10 and 10, per the lower and upper bounds of those design variables.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">openmdao.api</span> <span class="kn">as</span> <span class="nn">om</span>
<span class="kn">from</span> <span class="nn">openmdao.test_suite.components.paraboloid</span> <span class="kn">import</span> <span class="n">Paraboloid</span>

<span class="n">prob</span> <span class="o">=</span> <span class="n">om</span><span class="o">.</span><span class="n">Problem</span><span class="p">()</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">prob</span><span class="o">.</span><span class="n">model</span>

<span class="n">model</span><span class="o">.</span><span class="n">add_subsystem</span><span class="p">(</span><span class="s1">&#39;p1&#39;</span><span class="p">,</span> <span class="n">om</span><span class="o">.</span><span class="n">IndepVarComp</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="mf">0.</span><span class="p">),</span> <span class="n">promotes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;*&#39;</span><span class="p">])</span>
<span class="n">model</span><span class="o">.</span><span class="n">add_subsystem</span><span class="p">(</span><span class="s1">&#39;p2&#39;</span><span class="p">,</span> <span class="n">om</span><span class="o">.</span><span class="n">IndepVarComp</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="mf">0.</span><span class="p">),</span> <span class="n">promotes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;*&#39;</span><span class="p">])</span>
<span class="n">model</span><span class="o">.</span><span class="n">add_subsystem</span><span class="p">(</span><span class="s1">&#39;comp&#39;</span><span class="p">,</span> <span class="n">Paraboloid</span><span class="p">(),</span> <span class="n">promotes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;*&#39;</span><span class="p">])</span>

<span class="n">model</span><span class="o">.</span><span class="n">add_design_var</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">lower</span><span class="o">=-</span><span class="mi">10</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">add_design_var</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">lower</span><span class="o">=-</span><span class="mi">10</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">add_objective</span><span class="p">(</span><span class="s1">&#39;f_xy&#39;</span><span class="p">)</span>

<span class="n">prob</span><span class="o">.</span><span class="n">driver</span> <span class="o">=</span> <span class="n">om</span><span class="o">.</span><span class="n">DOEDriver</span><span class="p">(</span><span class="n">om</span><span class="o">.</span><span class="n">UniformGenerator</span><span class="p">(</span><span class="n">num_samples</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>
<span class="n">prob</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_recorder</span><span class="p">(</span><span class="n">om</span><span class="o">.</span><span class="n">SqliteRecorder</span><span class="p">(</span><span class="s2">&quot;cases.sql&quot;</span><span class="p">))</span>

<span class="n">prob</span><span class="o">.</span><span class="n">setup</span><span class="p">()</span>
<span class="n">prob</span><span class="o">.</span><span class="n">run_driver</span><span class="p">()</span>
<span class="n">prob</span><span class="o">.</span><span class="n">cleanup</span><span class="p">()</span>

<span class="n">cr</span> <span class="o">=</span> <span class="n">om</span><span class="o">.</span><span class="n">CaseReader</span><span class="p">(</span><span class="s2">&quot;cases.sql&quot;</span><span class="p">)</span>
<span class="n">cases</span> <span class="o">=</span> <span class="n">cr</span><span class="o">.</span><span class="n">list_cases</span><span class="p">(</span><span class="s1">&#39;driver&#39;</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cases</span><span class="p">))</span>
</pre></div>
</div>
<div class="cell border-box-sizing code_cell rendered"><div class="output_area"><pre>5</pre></div></div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">values</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cases</span><span class="p">)):</span>
    <span class="n">outputs</span> <span class="o">=</span> <span class="n">cr</span><span class="o">.</span><span class="n">get_case</span><span class="p">(</span><span class="n">cases</span><span class="p">[</span><span class="n">n</span><span class="p">])</span><span class="o">.</span><span class="n">outputs</span>
    <span class="n">values</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">outputs</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">outputs</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">outputs</span><span class="p">[</span><span class="s1">&#39;f_xy&#39;</span><span class="p">]))</span>

<span class="k">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;x: </span><span class="si">%5.2f</span><span class="s2">, y: </span><span class="si">%5.2f</span><span class="s2">, f_xy: </span><span class="si">%6.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">f_xy</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">f_xy</span> <span class="ow">in</span> <span class="n">values</span><span class="p">]))</span>
</pre></div>
</div>
<div class="cell border-box-sizing code_cell rendered"><div class="output_area"><pre>x:  8.13, y:  5.48, f_xy: 157.78
x: -3.34, y: -8.38, f_xy:  84.28
x: -1.86, y: -5.36, f_xy:  32.34
x: -7.35, y: -8.93, f_xy: 194.10
x:  4.51, y: -9.77, f_xy: -11.49</pre></div></div></div>
<div class="section" id="running-a-doe-in-parallel">
<span id="doe-driver-parallel"></span><h2>Running a DOE in Parallel<a class="headerlink" href="#running-a-doe-in-parallel" title="Permalink to this headline">¶</a></h2>
<p>In a parallel processing environment, it is possible for <cite>DOEDriver</cite> to run
cases concurrently. This is done by setting the <cite>run_parallel</cite> option to True as shown
in the following example.</p>
<p>Here we are using the <cite>FullFactorialGenerator</cite> with 3 levels to generate inputs
for our <cite>Paraboloid</cite> model. With two inputs, <span class="math notranslate nohighlight">\(3^2=9\)</span> cases have been
generated. In this case we are running on two processors and have specified
<code class="code docutils literal notranslate"><span class="pre">options['run_parallel']=True</span></code> to run cases on all available processors.
The cases have therefore been split with 5 cases run on the first processor
and 4 cases on the second.</p>
<p>Note that, when running in parallel, the <cite>SqliteRecorder</cite> will generate a separate
case file for each processor on which cases are recorded. The case files will have a
suffix indicating the recording rank and a message will be displayed indicating the
file name, as seen in the example.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">openmdao.api</span> <span class="kn">as</span> <span class="nn">om</span>
<span class="kn">from</span> <span class="nn">openmdao.test_suite.components.paraboloid</span> <span class="kn">import</span> <span class="n">Paraboloid</span>

<span class="kn">from</span> <span class="nn">mpi4py</span> <span class="kn">import</span> <span class="n">MPI</span>

<span class="n">prob</span> <span class="o">=</span> <span class="n">om</span><span class="o">.</span><span class="n">Problem</span><span class="p">()</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">prob</span><span class="o">.</span><span class="n">model</span>

<span class="n">model</span><span class="o">.</span><span class="n">add_subsystem</span><span class="p">(</span><span class="s1">&#39;p1&#39;</span><span class="p">,</span> <span class="n">om</span><span class="o">.</span><span class="n">IndepVarComp</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span> <span class="n">promotes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">])</span>
<span class="n">model</span><span class="o">.</span><span class="n">add_subsystem</span><span class="p">(</span><span class="s1">&#39;p2&#39;</span><span class="p">,</span> <span class="n">om</span><span class="o">.</span><span class="n">IndepVarComp</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span> <span class="n">promotes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">])</span>
<span class="n">model</span><span class="o">.</span><span class="n">add_subsystem</span><span class="p">(</span><span class="s1">&#39;comp&#39;</span><span class="p">,</span> <span class="n">Paraboloid</span><span class="p">(),</span> <span class="n">promotes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;f_xy&#39;</span><span class="p">])</span>

<span class="n">model</span><span class="o">.</span><span class="n">add_design_var</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">add_design_var</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">add_objective</span><span class="p">(</span><span class="s1">&#39;f_xy&#39;</span><span class="p">)</span>

<span class="n">prob</span><span class="o">.</span><span class="n">driver</span> <span class="o">=</span> <span class="n">om</span><span class="o">.</span><span class="n">DOEDriver</span><span class="p">(</span><span class="n">om</span><span class="o">.</span><span class="n">FullFactorialGenerator</span><span class="p">(</span><span class="n">levels</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span>
<span class="n">prob</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;run_parallel&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="bp">True</span>
<span class="n">prob</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;procs_per_model&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="mi">1</span>

<span class="n">prob</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_recorder</span><span class="p">(</span><span class="n">om</span><span class="o">.</span><span class="n">SqliteRecorder</span><span class="p">(</span><span class="s2">&quot;cases.sql&quot;</span><span class="p">))</span>

<span class="n">prob</span><span class="o">.</span><span class="n">setup</span><span class="p">()</span>
<span class="n">prob</span><span class="o">.</span><span class="n">run_driver</span><span class="p">()</span>
</pre></div>
</div>
<div class="cell border-box-sizing code_cell rendered"><div class="output_area"><pre>(rank 0) Note: SqliteRecorder is running on multiple processors. Cases from rank 0 are being written to cases.sql_0.
(rank 1) Note: SqliteRecorder is running on multiple processors. Cases from rank 1 are being written to cases.sql_1.
</pre></div></div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">prob</span><span class="o">.</span><span class="n">cleanup</span><span class="p">()</span>

<span class="k">print</span><span class="p">(</span><span class="n">MPI</span><span class="o">.</span><span class="n">COMM_WORLD</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell border-box-sizing code_cell rendered"><div class="output_area"><pre>(rank 0) 2
(rank 1) 2
</pre></div></div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># check recorded cases from each case file</span>
<span class="n">rank</span> <span class="o">=</span> <span class="n">MPI</span><span class="o">.</span><span class="n">COMM_WORLD</span><span class="o">.</span><span class="n">rank</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;cases.sql_</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">rank</span>
<span class="k">print</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell border-box-sizing code_cell rendered"><div class="output_area"><pre>(rank 0) cases.sql_0
(rank 1) cases.sql_1
</pre></div></div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cr</span> <span class="o">=</span> <span class="n">om</span><span class="o">.</span><span class="n">CaseReader</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<span class="n">cases</span> <span class="o">=</span> <span class="n">cr</span><span class="o">.</span><span class="n">list_cases</span><span class="p">(</span><span class="s1">&#39;driver&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cases</span><span class="p">))</span>
</pre></div>
</div>
<div class="cell border-box-sizing code_cell rendered"><div class="output_area"><pre>(rank 0) 5
(rank 1) 4
</pre></div></div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">values</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cases</span><span class="p">)):</span>
    <span class="n">outputs</span> <span class="o">=</span> <span class="n">cr</span><span class="o">.</span><span class="n">get_case</span><span class="p">(</span><span class="n">cases</span><span class="p">[</span><span class="n">n</span><span class="p">])</span><span class="o">.</span><span class="n">outputs</span>
    <span class="n">values</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">outputs</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">outputs</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">outputs</span><span class="p">[</span><span class="s1">&#39;f_xy&#39;</span><span class="p">]))</span>

<span class="k">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">+</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;x: </span><span class="si">%5.2f</span><span class="s2">, y: </span><span class="si">%5.2f</span><span class="s2">, f_xy: </span><span class="si">%6.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">f_xy</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">f_xy</span> <span class="ow">in</span> <span class="n">values</span><span class="p">]))</span>
</pre></div>
</div>
<div class="cell border-box-sizing code_cell rendered"><div class="output_area"><pre>(rank 0) x:  0.00, y:  0.00, f_xy:  22.00
x:  1.00, y:  0.00, f_xy:  17.00
x:  0.50, y:  0.50, f_xy:  23.75
x:  0.00, y:  1.00, f_xy:  31.00
x:  1.00, y:  1.00, f_xy:  27.00
(rank 1) x:  0.50, y:  0.00, f_xy:  19.25
x:  0.00, y:  0.50, f_xy:  26.25
x:  1.00, y:  0.50, f_xy:  21.75
x:  0.50, y:  1.00, f_xy:  28.75
</pre></div></div></div>
<div class="section" id="running-a-doe-in-parallel-with-a-parallel-model">
<h2>Running a DOE in Parallel with a Parallel Model<a class="headerlink" href="#running-a-doe-in-parallel-with-a-parallel-model" title="Permalink to this headline">¶</a></h2>
<p>If the model that is being subjected to the DOE is also parallel, then the total
number of processors should reflect the model size as well as the desired concurrency.</p>
<p>To illustrate this, we will demonstrate performing a DOE on a model based on the
<a class="reference internal" href="../../core_features/grouping_components/parallel_group.html#feature-parallel-group"><span class="std std-ref">ParallelGroup</span></a> example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">FanInGrouped</span><span class="p">(</span><span class="n">om</span><span class="o">.</span><span class="n">Group</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Topology where two components in a Group feed a single component</span>
<span class="sd">    outside of that Group.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">FanInGrouped</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="n">iv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_subsystem</span><span class="p">(</span><span class="s1">&#39;iv&#39;</span><span class="p">,</span> <span class="n">om</span><span class="o">.</span><span class="n">IndepVarComp</span><span class="p">())</span>
        <span class="n">iv</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
        <span class="n">iv</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;x2&#39;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
        <span class="n">iv</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;x3&#39;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">sub</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_subsystem</span><span class="p">(</span><span class="s1">&#39;sub&#39;</span><span class="p">,</span> <span class="n">om</span><span class="o">.</span><span class="n">ParallelGroup</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sub</span><span class="o">.</span><span class="n">add_subsystem</span><span class="p">(</span><span class="s1">&#39;c1&#39;</span><span class="p">,</span> <span class="n">om</span><span class="o">.</span><span class="n">ExecComp</span><span class="p">([</span><span class="s1">&#39;y=-2.0*x&#39;</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sub</span><span class="o">.</span><span class="n">add_subsystem</span><span class="p">(</span><span class="s1">&#39;c2&#39;</span><span class="p">,</span> <span class="n">om</span><span class="o">.</span><span class="n">ExecComp</span><span class="p">([</span><span class="s1">&#39;y=5.0*x&#39;</span><span class="p">]))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_subsystem</span><span class="p">(</span><span class="s1">&#39;c3&#39;</span><span class="p">,</span> <span class="n">om</span><span class="o">.</span><span class="n">ExecComp</span><span class="p">([</span><span class="s1">&#39;y=3.0*x1+7.0*x2&#39;</span><span class="p">]))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;sub.c1.y&quot;</span><span class="p">,</span> <span class="s2">&quot;c3.x1&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;sub.c2.y&quot;</span><span class="p">,</span> <span class="s2">&quot;c3.x2&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;iv.x1&quot;</span><span class="p">,</span> <span class="s2">&quot;sub.c1.x&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;iv.x2&quot;</span><span class="p">,</span> <span class="s2">&quot;sub.c2.x&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>In this case, the model itself requires two processors, so in order to run cases
concurrently we need to allocate at least four processors in total. We can allocate
as many processors as we have available, however the number of processors must be a multiple
of the number of processors per model, which is 2 here. Regardless of how many processors
we allocate, we need to tell the <cite>DOEDriver</cite> that the model needs 2 processors, which
is done by specifying <code class="code docutils literal notranslate"><span class="pre">options['procs_per_model']=2</span></code>. From this, the driver
figures out how many models it can run in parallel, which in this case is also 2.</p>
<p>The <cite>SqliteRecorder</cite> will record cases on the first two processors, which serve as
the “root” processors for the parallel cases.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">openmdao.api</span> <span class="kn">as</span> <span class="nn">om</span>
<span class="kn">from</span> <span class="nn">openmdao.test_suite.groups.parallel_groups</span> <span class="kn">import</span> <span class="n">FanInGrouped</span>

<span class="kn">from</span> <span class="nn">mpi4py</span> <span class="kn">import</span> <span class="n">MPI</span>

<span class="n">prob</span> <span class="o">=</span> <span class="n">om</span><span class="o">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">FanInGrouped</span><span class="p">())</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">prob</span><span class="o">.</span><span class="n">model</span>

<span class="n">model</span><span class="o">.</span><span class="n">add_design_var</span><span class="p">(</span><span class="s1">&#39;iv.x1&#39;</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">add_design_var</span><span class="p">(</span><span class="s1">&#39;iv.x2&#39;</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>

<span class="n">model</span><span class="o">.</span><span class="n">add_objective</span><span class="p">(</span><span class="s1">&#39;c3.y&#39;</span><span class="p">)</span>

<span class="n">prob</span><span class="o">.</span><span class="n">driver</span> <span class="o">=</span> <span class="n">om</span><span class="o">.</span><span class="n">DOEDriver</span><span class="p">(</span><span class="n">om</span><span class="o">.</span><span class="n">FullFactorialGenerator</span><span class="p">(</span><span class="n">levels</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span>
<span class="n">prob</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_recorder</span><span class="p">(</span><span class="n">om</span><span class="o">.</span><span class="n">SqliteRecorder</span><span class="p">(</span><span class="s2">&quot;cases.sql&quot;</span><span class="p">))</span>
<span class="n">prob</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;run_parallel&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="bp">True</span>

<span class="c1"># run 2 cases at a time, each using 2 of our 4 procs</span>
<span class="n">doe_parallel</span> <span class="o">=</span> <span class="n">prob</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;procs_per_model&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>

<span class="n">prob</span><span class="o">.</span><span class="n">setup</span><span class="p">()</span>
<span class="n">prob</span><span class="o">.</span><span class="n">run_driver</span><span class="p">()</span>
<span class="n">prob</span><span class="o">.</span><span class="n">cleanup</span><span class="p">()</span>

<span class="n">rank</span> <span class="o">=</span> <span class="n">MPI</span><span class="o">.</span><span class="n">COMM_WORLD</span><span class="o">.</span><span class="n">rank</span>

<span class="c1"># check recorded cases from each case file</span>
<span class="k">if</span> <span class="n">rank</span> <span class="o">&lt;</span> <span class="n">doe_parallel</span><span class="p">:</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;cases.sql_</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">rank</span>

    <span class="n">cr</span> <span class="o">=</span> <span class="n">om</span><span class="o">.</span><span class="n">CaseReader</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">cases</span> <span class="o">=</span> <span class="n">cr</span><span class="o">.</span><span class="n">list_cases</span><span class="p">(</span><span class="s1">&#39;driver&#39;</span><span class="p">)</span>

    <span class="n">values</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cases</span><span class="p">)):</span>
        <span class="n">outputs</span> <span class="o">=</span> <span class="n">cr</span><span class="o">.</span><span class="n">get_case</span><span class="p">(</span><span class="n">cases</span><span class="p">[</span><span class="n">n</span><span class="p">])</span><span class="o">.</span><span class="n">outputs</span>
        <span class="n">values</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">outputs</span><span class="p">[</span><span class="s1">&#39;iv.x1&#39;</span><span class="p">],</span> <span class="n">outputs</span><span class="p">[</span><span class="s1">&#39;iv.x2&#39;</span><span class="p">],</span> <span class="n">outputs</span><span class="p">[</span><span class="s1">&#39;c3.y&#39;</span><span class="p">]))</span>

    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">+</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;iv.x1: </span><span class="si">%5.2f</span><span class="s2">, iv.x2: </span><span class="si">%5.2f</span><span class="s2">, c3.y: </span><span class="si">%6.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">values</span><span class="p">]))</span>
</pre></div>
</div>
<div class="cell border-box-sizing code_cell rendered"><div class="output_area"><pre>Note: SqliteRecorder is running on multiple processors. Cases from rank 0 are being written to cases.sql_0.

iv.x1:  0.00, iv.x2:  0.00, c3.y:   0.00
iv.x1:  1.00, iv.x2:  0.00, c3.y:  -6.00
iv.x1:  0.50, iv.x2:  0.50, c3.y:  14.50
iv.x1:  0.00, iv.x2:  1.00, c3.y:  35.00
iv.x1:  1.00, iv.x2:  1.00, c3.y:  29.00

Note: SqliteRecorder is running on multiple processors. Cases from rank 1 are being written to cases.sql_1.

iv.x1:  0.50, iv.x2:  0.00, c3.y:  -3.00
iv.x1:  0.00, iv.x2:  0.50, c3.y:  17.50
iv.x1:  1.00, iv.x2:  0.50, c3.y:  11.50
iv.x1:  0.50, iv.x2:  1.00, c3.y:  32.00


</pre></div></div></div>
<div class="section" id="using-prepared-cases">
<h2>Using Prepared Cases<a class="headerlink" href="#using-prepared-cases" title="Permalink to this headline">¶</a></h2>
<p>If you have a previously generated set of cases that you want to run using <cite>DOEDriver</cite>,
there are a couple of ways to do that. The first is to provide those inputs via an
external file in the CSV (comma separated values) format.  The file should be organized
with one column per design variable, with the first row containing the names of the design
variables. The following example demonstrates how to use such a file to run a DOE using
the <cite>CSVGenerator</cite>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">openmdao.api</span> <span class="kn">as</span> <span class="nn">om</span>
<span class="kn">from</span> <span class="nn">openmdao.test_suite.components.paraboloid</span> <span class="kn">import</span> <span class="n">Paraboloid</span>

<span class="n">prob</span> <span class="o">=</span> <span class="n">om</span><span class="o">.</span><span class="n">Problem</span><span class="p">()</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">prob</span><span class="o">.</span><span class="n">model</span>

<span class="n">model</span><span class="o">.</span><span class="n">add_subsystem</span><span class="p">(</span><span class="s1">&#39;p1&#39;</span><span class="p">,</span> <span class="n">om</span><span class="o">.</span><span class="n">IndepVarComp</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span> <span class="n">promotes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">])</span>
<span class="n">model</span><span class="o">.</span><span class="n">add_subsystem</span><span class="p">(</span><span class="s1">&#39;p2&#39;</span><span class="p">,</span> <span class="n">om</span><span class="o">.</span><span class="n">IndepVarComp</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span> <span class="n">promotes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">])</span>
<span class="n">model</span><span class="o">.</span><span class="n">add_subsystem</span><span class="p">(</span><span class="s1">&#39;comp&#39;</span><span class="p">,</span> <span class="n">Paraboloid</span><span class="p">(),</span> <span class="n">promotes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;f_xy&#39;</span><span class="p">])</span>

<span class="n">model</span><span class="o">.</span><span class="n">add_design_var</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">add_design_var</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">add_objective</span><span class="p">(</span><span class="s1">&#39;f_xy&#39;</span><span class="p">)</span>

<span class="n">prob</span><span class="o">.</span><span class="n">setup</span><span class="p">()</span>

<span class="c1"># this file contains design variable inputs in CSV format</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;cases.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</pre></div>
</div>
<div class="cell border-box-sizing code_cell rendered"><div class="output_area"><pre>x ,   y
0.0,  0.0
0.5,  0.0
1.0,  0.0
0.0,  0.5
0.5,  0.5
1.0,  0.5
0.0,  1.0
0.5,  1.0
1.0,  1.0</pre></div></div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># run problem with DOEDriver using the CSV file</span>
<span class="n">prob</span><span class="o">.</span><span class="n">driver</span> <span class="o">=</span> <span class="n">om</span><span class="o">.</span><span class="n">DOEDriver</span><span class="p">(</span><span class="n">om</span><span class="o">.</span><span class="n">CSVGenerator</span><span class="p">(</span><span class="s1">&#39;cases.csv&#39;</span><span class="p">))</span>
<span class="n">prob</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_recorder</span><span class="p">(</span><span class="n">om</span><span class="o">.</span><span class="n">SqliteRecorder</span><span class="p">(</span><span class="s2">&quot;cases.sql&quot;</span><span class="p">))</span>

<span class="n">prob</span><span class="o">.</span><span class="n">run_driver</span><span class="p">()</span>
<span class="n">prob</span><span class="o">.</span><span class="n">cleanup</span><span class="p">()</span>

<span class="n">cr</span> <span class="o">=</span> <span class="n">om</span><span class="o">.</span><span class="n">CaseReader</span><span class="p">(</span><span class="s2">&quot;cases.sql&quot;</span><span class="p">)</span>
<span class="n">cases</span> <span class="o">=</span> <span class="n">cr</span><span class="o">.</span><span class="n">list_cases</span><span class="p">(</span><span class="s1">&#39;driver&#39;</span><span class="p">)</span>

<span class="n">values</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cases</span><span class="p">)):</span>
    <span class="n">outputs</span> <span class="o">=</span> <span class="n">cr</span><span class="o">.</span><span class="n">get_case</span><span class="p">(</span><span class="n">cases</span><span class="p">[</span><span class="n">n</span><span class="p">])</span><span class="o">.</span><span class="n">outputs</span>
    <span class="n">values</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">outputs</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">outputs</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">outputs</span><span class="p">[</span><span class="s1">&#39;f_xy&#39;</span><span class="p">]))</span>

<span class="k">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;x: </span><span class="si">%5.2f</span><span class="s2">, y: </span><span class="si">%5.2f</span><span class="s2">, f_xy: </span><span class="si">%6.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">f_xy</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">f_xy</span> <span class="ow">in</span> <span class="n">values</span><span class="p">]))</span>
</pre></div>
</div>
<div class="cell border-box-sizing code_cell rendered"><div class="output_area"><pre>x:  0.00, y:  0.00, f_xy:  22.00
x:  0.50, y:  0.00, f_xy:  19.25
x:  1.00, y:  0.00, f_xy:  17.00
x:  0.00, y:  0.50, f_xy:  26.25
x:  0.50, y:  0.50, f_xy:  23.75
x:  1.00, y:  0.50, f_xy:  21.75
x:  0.00, y:  1.00, f_xy:  31.00
x:  0.50, y:  1.00, f_xy:  28.75
x:  1.00, y:  1.00, f_xy:  27.00</pre></div></div><p>The second method is to provide the data directly as a list of cases, where each case is a
collection of name/value pairs for the design variables. You might use this method if you
want to generate the cases programmatically via another algorithm or if the data is
available in some format other than a CSV file and you can reformat it into this simple
list structure. The <cite>DOEGenerator</cite> you would use in this case is the <cite>ListGenerator</cite>,
but if you pass a list directly to the <cite>DOEDriver</cite> it will construct the <cite>ListGenerator</cite>
for you. In the following example, a set of cases has been pre-generated and saved in JSON
(JavaScript Object Notation) format. The data is decoded and provided to the <cite>DOEDriver</cite>
as a list:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">openmdao.api</span> <span class="kn">as</span> <span class="nn">om</span>
<span class="kn">from</span> <span class="nn">openmdao.test_suite.components.paraboloid</span> <span class="kn">import</span> <span class="n">Paraboloid</span>

<span class="kn">import</span> <span class="nn">json</span>

<span class="n">prob</span> <span class="o">=</span> <span class="n">om</span><span class="o">.</span><span class="n">Problem</span><span class="p">()</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">prob</span><span class="o">.</span><span class="n">model</span>

<span class="n">model</span><span class="o">.</span><span class="n">add_subsystem</span><span class="p">(</span><span class="s1">&#39;p1&#39;</span><span class="p">,</span> <span class="n">om</span><span class="o">.</span><span class="n">IndepVarComp</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span> <span class="n">promotes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">])</span>
<span class="n">model</span><span class="o">.</span><span class="n">add_subsystem</span><span class="p">(</span><span class="s1">&#39;p2&#39;</span><span class="p">,</span> <span class="n">om</span><span class="o">.</span><span class="n">IndepVarComp</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span> <span class="n">promotes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">])</span>
<span class="n">model</span><span class="o">.</span><span class="n">add_subsystem</span><span class="p">(</span><span class="s1">&#39;comp&#39;</span><span class="p">,</span> <span class="n">Paraboloid</span><span class="p">(),</span> <span class="n">promotes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;f_xy&#39;</span><span class="p">])</span>

<span class="n">model</span><span class="o">.</span><span class="n">add_design_var</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">add_design_var</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">add_objective</span><span class="p">(</span><span class="s1">&#39;f_xy&#39;</span><span class="p">)</span>

<span class="n">prob</span><span class="o">.</span><span class="n">setup</span><span class="p">()</span>

<span class="c1"># load design variable inputs from JSON file and decode into list</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;cases.json&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">json_data</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

<span class="k">print</span><span class="p">(</span><span class="n">json_data</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell border-box-sizing code_cell rendered"><div class="output_area"><pre>[[[&quot;x&quot;, [0.0]], [&quot;y&quot;, [0.0]]],
 [[&quot;x&quot;, [0.5]], [&quot;y&quot;, [0.0]]],
 [[&quot;x&quot;, [1.0]], [&quot;y&quot;, [0.0]]],
 [[&quot;x&quot;, [0.0]], [&quot;y&quot;, [0.5]]],
 [[&quot;x&quot;, [0.5]], [&quot;y&quot;, [0.5]]],
 [[&quot;x&quot;, [1.0]], [&quot;y&quot;, [0.5]]],
 [[&quot;x&quot;, [0.0]], [&quot;y&quot;, [1.0]]],
 [[&quot;x&quot;, [0.5]], [&quot;y&quot;, [1.0]]],
 [[&quot;x&quot;, [1.0]], [&quot;y&quot;, [1.0]]]]</pre></div></div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">case_list</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">json_data</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">case_list</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell border-box-sizing code_cell rendered"><div class="output_area"><pre>[[[&#x27;x&#x27;, [0.0]], [&#x27;y&#x27;, [0.0]]], [[&#x27;x&#x27;, [0.5]], [&#x27;y&#x27;, [0.0]]], [[&#x27;x&#x27;, [1.0]], [&#x27;y&#x27;, [0.0]]], [[&#x27;x&#x27;, [0.0]], [&#x27;y&#x27;, [0.5]]], [[&#x27;x&#x27;, [0.5]], [&#x27;y&#x27;, [0.5]]], [[&#x27;x&#x27;, [1.0]], [&#x27;y&#x27;, [0.5]]], [[&#x27;x&#x27;, [0.0]], [&#x27;y&#x27;, [1.0]]], [[&#x27;x&#x27;, [0.5]], [&#x27;y&#x27;, [1.0]]], [[&#x27;x&#x27;, [1.0]], [&#x27;y&#x27;, [1.0]]]]</pre></div></div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># create DOEDriver using provided list of cases</span>
<span class="n">prob</span><span class="o">.</span><span class="n">driver</span> <span class="o">=</span> <span class="n">om</span><span class="o">.</span><span class="n">DOEDriver</span><span class="p">(</span><span class="n">case_list</span><span class="p">)</span>

<span class="c1"># a ListGenerator was created</span>
<span class="k">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">prob</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;generator&#39;</span><span class="p">]))</span>
</pre></div>
</div>
<div class="cell border-box-sizing code_cell rendered"><div class="output_area"><pre>&lt;class &#x27;openmdao.drivers.doe_generators.ListGenerator&#x27;&gt;</pre></div></div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">prob</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_recorder</span><span class="p">(</span><span class="n">om</span><span class="o">.</span><span class="n">SqliteRecorder</span><span class="p">(</span><span class="s2">&quot;cases.sql&quot;</span><span class="p">))</span>

<span class="n">prob</span><span class="o">.</span><span class="n">run_driver</span><span class="p">()</span>
<span class="n">prob</span><span class="o">.</span><span class="n">cleanup</span><span class="p">()</span>

<span class="n">cr</span> <span class="o">=</span> <span class="n">om</span><span class="o">.</span><span class="n">CaseReader</span><span class="p">(</span><span class="s2">&quot;cases.sql&quot;</span><span class="p">)</span>
<span class="n">cases</span> <span class="o">=</span> <span class="n">cr</span><span class="o">.</span><span class="n">list_cases</span><span class="p">(</span><span class="s1">&#39;driver&#39;</span><span class="p">)</span>

<span class="n">values</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cases</span><span class="p">)):</span>
    <span class="n">outputs</span> <span class="o">=</span> <span class="n">cr</span><span class="o">.</span><span class="n">get_case</span><span class="p">(</span><span class="n">cases</span><span class="p">[</span><span class="n">n</span><span class="p">])</span><span class="o">.</span><span class="n">outputs</span>
    <span class="n">values</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">outputs</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">outputs</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">outputs</span><span class="p">[</span><span class="s1">&#39;f_xy&#39;</span><span class="p">]))</span>

<span class="k">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;x: </span><span class="si">%5.2f</span><span class="s2">, y: </span><span class="si">%5.2f</span><span class="s2">, f_xy: </span><span class="si">%6.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">f_xy</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">f_xy</span> <span class="ow">in</span> <span class="n">values</span><span class="p">]))</span>
</pre></div>
</div>
<div class="cell border-box-sizing code_cell rendered"><div class="output_area"><pre>x:  0.00, y:  0.00, f_xy:  22.00
x:  0.50, y:  0.00, f_xy:  19.25
x:  1.00, y:  0.00, f_xy:  17.00
x:  0.00, y:  0.50, f_xy:  26.25
x:  0.50, y:  0.50, f_xy:  23.75
x:  1.00, y:  0.50, f_xy:  21.75
x:  0.00, y:  1.00, f_xy:  31.00
x:  0.50, y:  1.00, f_xy:  28.75
x:  1.00, y:  1.00, f_xy:  27.00</pre></div></div><div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">When using pre-generated cases via <cite>CSVGenerator</cite> or <cite>ListGenerator</cite>, there is no
enforcement of the declared bounds on a design variable as with the algorithmic
generators.</p>
</div>
<div class="admonition-tags admonition" id="tag-0">
<p class="first admonition-title">Tags</p>
<p class="last"><a class="reference internal" href="../../../tags/Driver.html#driver"><span class="std std-ref">Driver</span></a>, <a class="reference internal" href="../../../tags/DOE.html#doe"><span class="std std-ref">DOE</span></a></p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../solvers/index.html" title="Solvers"
             >next</a> |</li>
        <li class="right" >
          <a href="genetic_algorithm.html" title="SimpleGADriver"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">OpenMDAO 2.8.0 Beta documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Features</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../index.html" >Building Blocks</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="index.html" >Drivers</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2016, openmdao.org.
      Last updated on Aug 08, 2019.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.1.
    </div>
  </body>
</html>