
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Specifying Units for Variables &#8212; OpenMDAO 2.8.0 Beta documentation</title>
    <link rel="stylesheet" href="../../../_static/style.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../../../_static/OpenMDAO_Favicon.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Scaling Variables" href="scaling.html" />
    <link rel="prev" title="Distributed Components" href="distributed_comps.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="scaling.html" title="Scaling Variables"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="distributed_comps.html" title="Distributed Components"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">OpenMDAO 2.8.0 Beta documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Features</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../index.html" >Core Features</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="index.html" accesskey="U">Working with Components</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../index.html">
              <img class="logo" src="../../../_static/OpenMDAO_Logo.png" alt="Logo"/>
            </a></p>
<h3><a href="../../../index.html">Table of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../getting_started/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../basic_guide/index.html">Basic User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../advanced_guide/index.html">Advanced User Guide</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../theory_manual/index.html">Theory Manual</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../other/om_command.html">Command Line Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../other/citing.html">How to Cite OpenMDAO</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../other/repo_guide/index.html">Building a Tool on Top of OpenMDAO</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../other/api_translation.html">Upgrading from OpenMDAO 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../other/file_wrap.html">File Wrapping</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../_srcdocs/index.html">Source Docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developer_docs/index.html">Developer Docs (if you’re going to contribute code)</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Search OpenMDAO</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="checkbox" name="search_source" /> Include Source Docs
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="specifying-units-for-variables">
<span id="units"></span><h1>Specifying Units for Variables<a class="headerlink" href="#specifying-units-for-variables" title="Permalink to this headline">¶</a></h1>
<p>As we saw in <a class="reference internal" href="declaring_variables.html#declaring-variables"><span class="std std-ref">Declaring Variables</span></a>, we can specify units for inputs, outputs, and residuals.
There is a <code class="code docutils literal notranslate"><span class="pre">units</span></code> argument to <code class="code docutils literal notranslate"><span class="pre">add_input</span></code> to specify input units,
and there are <code class="code docutils literal notranslate"><span class="pre">units</span></code> and <code class="code docutils literal notranslate"><span class="pre">res_units</span></code> arguments on <code class="code docutils literal notranslate"><span class="pre">add_output</span></code> to specify output and residual units, respectively.
A complete listing of all available units is given <a class="reference internal" href="../../units.html#feature-units"><span class="std std-ref">here</span></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Residual units, if not specified, default to the same units as the output variable.
<code class="code docutils literal notranslate"><span class="pre">res_units</span></code> is very rarely specified.</p>
</div>
<p>Specifying units has the following result:</p>
<p>1. Unit conversions occur during data passing.
For instance, let’s say we have a <code class="code docutils literal notranslate"><span class="pre">TimeComp</span></code> component that outputs <code class="code docutils literal notranslate"><span class="pre">time1</span></code> in hours and a <code class="code docutils literal notranslate"><span class="pre">SpeedComp</span></code> component takes <code class="code docutils literal notranslate"><span class="pre">time2</span></code> as an input but in seconds.
If we connect <code class="code docutils literal notranslate"><span class="pre">TimeComp.time1</span></code> to <code class="code docutils literal notranslate"><span class="pre">SpeedComp.time2</span></code> with hours/seconds specified during the corresponding <code class="code docutils literal notranslate"><span class="pre">add_output</span></code>/<code class="code docutils literal notranslate"><span class="pre">add_input</span></code> calls, then OpenMDAO automatically converts from hours to seconds.</p>
<p>2. The user always gets/sets the variable in the specified units.
Declaring an input, output, or residual to have certain units means that any value ‘set’ into the variable is assumed to be in the given units and any time the user asks to ‘get’ the variable, the value is return in the given units.
This is the case not only in &lt;Component&gt; methods such as <code class="code docutils literal notranslate"><span class="pre">compute</span></code>, <code class="code docutils literal notranslate"><span class="pre">apply_nonlinear</span></code>, and <code class="code docutils literal notranslate"><span class="pre">apply_linear</span></code>, but everywhere, including the user’s run script.</p>
<p>3. In <code class="code docutils literal notranslate"><span class="pre">add_input</span></code> and <code class="code docutils literal notranslate"><span class="pre">add_output</span></code>, all arguments are assumed to be given in the specified units.
In the case of <code class="code docutils literal notranslate"><span class="pre">add_input</span></code>, if <code class="code docutils literal notranslate"><span class="pre">units</span></code> is specified, then <code class="code docutils literal notranslate"><span class="pre">val</span></code> is assumed to be given in those units.
In the case of <code class="code docutils literal notranslate"><span class="pre">add_output</span></code>, if <code class="code docutils literal notranslate"><span class="pre">units</span></code> is specified, then <code class="code docutils literal notranslate"><span class="pre">val</span></code>, <code class="code docutils literal notranslate"><span class="pre">lower</span></code>, <code class="code docutils literal notranslate"><span class="pre">upper</span></code>, <code class="code docutils literal notranslate"><span class="pre">ref</span></code>, and <code class="code docutils literal notranslate"><span class="pre">ref0</span></code> are all assumed to be given in those units.
Also in <code class="code docutils literal notranslate"><span class="pre">add_output</span></code>, if <code class="code docutils literal notranslate"><span class="pre">res_units</span></code> is specified, then <code class="code docutils literal notranslate"><span class="pre">res_ref</span></code> is assumed to be given in <code class="code docutils literal notranslate"><span class="pre">res_units</span></code>.</p>
<div class="section" id="units-syntax">
<h2>Units syntax<a class="headerlink" href="#units-syntax" title="Permalink to this headline">¶</a></h2>
<p>Units are specified as a string that adheres to the following syntax.
The string is a composition of numbers and known units that are combined with multiplication (<code class="code docutils literal notranslate"><span class="pre">*</span></code>), division (<code class="code docutils literal notranslate"><span class="pre">/</span></code>), and exponentiation (<code class="code docutils literal notranslate"><span class="pre">**</span></code>) operators.
The known units can be prefixed by kilo (<cite>k</cite>), Mega (<cite>M</cite>), and so on.
The list of units and valid prefixes can be found in the <a class="reference internal" href="../../units.html#feature-units"><span class="std std-ref">units library</span></a>.</p>
<p>For example, each of the following is a valid unit string representing the same quantity:</p>
<ul class="simple">
<li><code class="code docutils literal notranslate"><span class="pre">N</span></code></li>
<li><code class="code docutils literal notranslate"><span class="pre">0.224809</span> <span class="pre">*</span> <span class="pre">lbf</span></code></li>
<li><code class="code docutils literal notranslate"><span class="pre">kg</span> <span class="pre">*</span> <span class="pre">m</span> <span class="pre">/</span> <span class="pre">s</span> <span class="pre">**</span> <span class="pre">2</span></code></li>
<li><code class="code docutils literal notranslate"><span class="pre">kg</span> <span class="pre">*</span> <span class="pre">m</span> <span class="pre">*</span> <span class="pre">s</span> <span class="pre">**</span> <span class="pre">-2</span></code></li>
<li><code class="code docutils literal notranslate"><span class="pre">kkg</span> <span class="pre">*</span> <span class="pre">mm</span> <span class="pre">/</span> <span class="pre">s</span> <span class="pre">**</span> <span class="pre">2</span></code></li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If units are not specified, or are specified as <code class="code docutils literal notranslate"><span class="pre">None</span></code> then the variable
is assumed to be unitless.  If such a variable is connected to a variable
with units, the connection will be allowed, but a warning will be issued.</p>
</div>
</div>
<div class="section" id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h2>
<p>This example illustrates how we can compute speed from distance and time given in <code class="code docutils literal notranslate"><span class="pre">km</span></code> and <code class="code docutils literal notranslate"><span class="pre">h</span></code> using a component that computes speed using <code class="code docutils literal notranslate"><span class="pre">m</span></code> and <code class="code docutils literal notranslate"><span class="pre">s</span></code>.</p>
<p>We first define the component.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">SpeedComp</span><span class="p">(</span><span class="n">om</span><span class="o">.</span><span class="n">ExplicitComponent</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Simple speed computation from distance and time with unit conversations.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_input</span><span class="p">(</span><span class="s1">&#39;distance&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;km&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_input</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;h&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;speed&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;km/h&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">compute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="p">):</span>
        <span class="n">outputs</span><span class="p">[</span><span class="s1">&#39;speed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">[</span><span class="s1">&#39;distance&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">inputs</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>In the overall problem, the first component, <code class="code docutils literal notranslate"><span class="pre">c1</span></code>, defines distance and time in <code class="code docutils literal notranslate"><span class="pre">m</span></code> and <code class="code docutils literal notranslate"><span class="pre">s</span></code>.
OpenMDAO handles the unit conversions when passing these two variables into <code class="code docutils literal notranslate"><span class="pre">c2</span></code>, our ‘SpeedComp’.
There is a further unit conversion from <code class="code docutils literal notranslate"><span class="pre">c2</span></code> to <code class="code docutils literal notranslate"><span class="pre">c3</span></code> since speed must be converted now to <code class="code docutils literal notranslate"><span class="pre">m/s</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">openmdao.api</span> <span class="kn">as</span> <span class="nn">om</span>
<span class="kn">from</span> <span class="nn">openmdao.core.tests.test_units</span> <span class="kn">import</span> <span class="n">SpeedComp</span>

<span class="n">comp</span> <span class="o">=</span> <span class="n">om</span><span class="o">.</span><span class="n">IndepVarComp</span><span class="p">()</span>
<span class="n">comp</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;distance&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">)</span>
<span class="n">comp</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>

<span class="n">prob</span> <span class="o">=</span> <span class="n">om</span><span class="o">.</span><span class="n">Problem</span><span class="p">()</span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_subsystem</span><span class="p">(</span><span class="s1">&#39;c1&#39;</span><span class="p">,</span> <span class="n">comp</span><span class="p">)</span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_subsystem</span><span class="p">(</span><span class="s1">&#39;c2&#39;</span><span class="p">,</span> <span class="n">SpeedComp</span><span class="p">())</span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_subsystem</span><span class="p">(</span><span class="s1">&#39;c3&#39;</span><span class="p">,</span> <span class="n">om</span><span class="o">.</span><span class="n">ExecComp</span><span class="p">(</span><span class="s1">&#39;f=speed&#39;</span><span class="p">,</span><span class="n">speed</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;m/s&#39;</span><span class="p">}))</span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;c1.distance&#39;</span><span class="p">,</span> <span class="s1">&#39;c2.distance&#39;</span><span class="p">)</span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;c1.time&#39;</span><span class="p">,</span> <span class="s1">&#39;c2.time&#39;</span><span class="p">)</span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;c2.speed&#39;</span><span class="p">,</span> <span class="s1">&#39;c3.speed&#39;</span><span class="p">)</span>

<span class="n">prob</span><span class="o">.</span><span class="n">setup</span><span class="p">()</span>
<span class="n">prob</span><span class="o">.</span><span class="n">run_model</span><span class="p">()</span>

<span class="k">print</span><span class="p">(</span><span class="n">prob</span><span class="p">[</span><span class="s1">&#39;c1.distance&#39;</span><span class="p">])</span>  <span class="c1"># units: m</span>
</pre></div>
</div>
<div class="cell border-box-sizing code_cell rendered"><div class="output_area"><pre>[1.]</pre></div></div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">prob</span><span class="p">[</span><span class="s1">&#39;c2.distance&#39;</span><span class="p">])</span>  <span class="c1"># units: km</span>
</pre></div>
</div>
<div class="cell border-box-sizing code_cell rendered"><div class="output_area"><pre>[0.001]</pre></div></div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">prob</span><span class="p">[</span><span class="s1">&#39;c1.time&#39;</span><span class="p">])</span>  <span class="c1"># units: s</span>
</pre></div>
</div>
<div class="cell border-box-sizing code_cell rendered"><div class="output_area"><pre>[1.]</pre></div></div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">prob</span><span class="p">[</span><span class="s1">&#39;c2.time&#39;</span><span class="p">])</span>  <span class="c1"># units: h</span>
</pre></div>
</div>
<div class="cell border-box-sizing code_cell rendered"><div class="output_area"><pre>[0.00027778]</pre></div></div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">prob</span><span class="p">[</span><span class="s1">&#39;c2.speed&#39;</span><span class="p">])</span>  <span class="c1"># units: km/h</span>
</pre></div>
</div>
<div class="cell border-box-sizing code_cell rendered"><div class="output_area"><pre>[3.6]</pre></div></div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">prob</span><span class="p">[</span><span class="s1">&#39;c3.f&#39;</span><span class="p">])</span>  <span class="c1"># units: km/h</span>
</pre></div>
</div>
<div class="cell border-box-sizing code_cell rendered"><div class="output_area"><pre>[1.]</pre></div></div></div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="scaling.html" title="Scaling Variables"
             >next</a> |</li>
        <li class="right" >
          <a href="distributed_comps.html" title="Distributed Components"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">OpenMDAO 2.8.0 Beta documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Features</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../index.html" >Core Features</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="index.html" >Working with Components</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2016, openmdao.org.
      Last updated on Aug 08, 2019.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.1.
    </div>
  </body>
</html>